version: "2"
services:
  mqtt:
    image:  eclipse-mosquitto
    volumes:
      - "mosquitto_config:/mosquitto/config"
      - "mosquitto_data:/mosquitto/data"
      - "mosquitto_log:/mosquitto/log"
  openhab:
    image: "openhab/openhab:2.3.0-armhf-debian"
    environment:
      - USER_ID=999
      - GROUP_ID=995
    network_mode: "host"
    restart: always
    tty: true
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - /etc/timezone:/etc/timezone:ro
      - "openhab_conf:/openhab/conf"
      - "openhab_userdata:/openhab/userdata"
      - "openhab_addons:/openhab/addons"
    ports: 
      - "8080:8080"
      - "8433:8433"
    links:
      - "mqtt:broker"
  nodered:
    image: "nodered/node-red-docker:rpi"
    restart: always
    volumes:
      - "nodered_userdata:/data"
    ports: 
      - "1880:1880"
    links:
      - "mqtt:broker"
volumes:
  openhab_conf:
  openhab_userdata:
  openhab_addons:
  nodered_userdata:
  mosquitto_config:
  mosquitto_data:
  mosquitto_log:
